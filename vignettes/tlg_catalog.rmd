---
title: "Chevron Catalog Version x.x.x"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **TABLES**
### **Demographics and Baseline Characteristics (DMT01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_dmt01.html))**
  
#### **1. Demographics and Baseline Characteristics with All Patients**
1) The **dmt01** template produces the standard demographics and baseline characteristics summary.  
2) This template includes the column of total by default.  
```{r eval=FALSE}
run(dmt01,adam_db=syn_data)
```
```{r echo=FALSE}
run(dmt01,adam_db=syn_data)
```

#### **2. Demographics and Baseline Characteristics without All Patients**
To remove the column of total, set the parameter *lbl_overall* to *NULL*. 
```{r eval=FALSE}
run(dmt01,adam_db=syn_data,lbl_overall=NULL)
```
```{r echo=FALSE}
run(dmt01,adam_db=syn_data,lbl_overall=NULL)
```

#### **3. Demographics and Baseline Characteristics with an additional study specific continuous variable**
1) Study specific continuous variables can be added to the standard demographics and baseline characteristics summary by editing the parameter *summaryvars*. To add or remove analyses, you need to list all variables you would like to include in the parameter.  
2) CHEVRON performs the analysis based on the type of variable as defined in the input data.    
```{r eval=FALSE}
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "BBMISI"),lbl_overall=NULL)
```
```{r echo=FALSE}
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "BBMISI"),lbl_overall=NULL)
```

#### **4. Demographics and Baseline Characteristics with an additional study specific categorical variable**
1) Study specific categorical variables can be added to the standard demographics and baseline characteristics summary by editing the parameter *summaryvars*.   
2) To display the values within a categorical variable in pre-specified order, the categorical variable need to be factorized with pre-specified order provided as levels.
```{r eval=FALSE}
syn_data$adsl <- syn_data$adsl %>%
  mutate(BBMIGR1 = case_when(BBMISI < 15 ~ "Very severely underweight",
                             BBMISI >= 15 & BBMISI < 16 ~ "Severely underweight",
                             BBMISI >= 16 & BBMISI <18.5 ~ "Underweight",
                             BBMISI >= 18.5 & BBMISI <25 ~ "Normal (healthy weight)",
                             BBMISI >= 25 & BBMISI <30 ~ "Overweight",
                             BBMISI >= 30 & BBMISI <35 ~ "Obese Class I (Moderately obese)",
                             BBMISI >= 35 & BBMISI <40 ~ "Obese Class II (Severely obese)",
                             BBMISI >= 40              ~ "Obese Class III (Very severely obese)")) %>%
  mutate(BBMIGR1 = factor(BBMIGR1,levels = c("Very severely underweight","Severely underweight","Underweight","Normal (healthy weight)","Overweight","Obese Class I (Moderately obese)","Obese Class II (Severely obese)","Obese Class III (Very severely obese)")))
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "BBMIGR1"))
```
```{r echo=FALSE}
syn_data$adsl <- syn_data$adsl %>%
  mutate(BBMIGR1 = case_when(BBMISI < 15 ~ "Very severely underweight",
                             BBMISI >= 15 & BBMISI < 16 ~ "Severely underweight",
                             BBMISI >= 16 & BBMISI <18.5 ~ "Underweight",
                             BBMISI >= 18.5 & BBMISI <25 ~ "Normal (healthy weight)",
                             BBMISI >= 25 & BBMISI <30 ~ "Overweight",
                             BBMISI >= 30 & BBMISI <35 ~ "Obese Class I (Moderately obese)",
                             BBMISI >= 35 & BBMISI <40 ~ "Obese Class II (Severely obese)",
                             BBMISI >= 40              ~ "Obese Class III (Very severely obese)")) %>%
  mutate(BBMIGR1 = factor(BBMIGR1,levels = c("Very severely underweight","Severely underweight","Underweight","Normal (healthy weight)","Overweight","Obese Class I (Moderately obese)","Obese Class II (Severely obese)","Obese Class III (Very severely obese)")))
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "BBMIGR1"))
```

#### **5. Demographics and Baseline Characteristics with additional vital signs baseline values from ADVS or ADSUB**
To add baseline vital signs or other baseline characteristics to the demographics and baseline characteristics summary, manual preprocess of input *adsl* dataset is expected and merge the vital signs baseline values from *advs* (where ADVS.ABLFL=='Y']) or *adsub* with *adsl* by unique subject identifier.
```{r eval=FALSE}
diabpbl <- syn_data$advs %>%
  filter(ABLFL=='Y' & PARAMCD == 'DIABP') %>%
  mutate(DIABPBL = AVAL) %>%
  select('STUDYID','USUBJID','DIABPBL')
syn_data$adsl <- syn_data$adsl %>%
  left_join(diabpbl,by=c('STUDYID','USUBJID'))
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "DIABPBL"))
```
```{r echo=FALSE}
diabpbl <- syn_data$advs %>%
  filter(ABLFL=='Y' & PARAMCD == 'DIABP') %>%
  mutate(DIABPBL = AVAL) %>%
  select('STUDYID','USUBJID','DIABPBL')
syn_data$adsl <- syn_data$adsl %>%
  left_join(diabpbl,by=c('STUDYID','USUBJID'))
run(dmt01,adam_db = syn_data,summaryvars = c("AGE", "AGEGR1", "SEX", "ETHNIC", "RACE", "DIABPBL"))
```

### **Patient Disposition (DST01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_dst01.html))**

#### **1. Patient Disposition**
1) The **dst01** template produces the standard patient disposition summary.  
2) The template includes the column of total by default. Use *lbl_overall=NULL* to suppress the default.   
```{r eval=FALSE}
run(dst01,adam_db=syn_data,lbl_overall=NULL)
```
```{r echo=FALSE}
run(dst01,adam_db=syn_data,lbl_overall=NULL)
```
#### **2. Patient Disposition (with grouping of reasons)**
1) The syntax below produces the standard patient disposition summary with grouping of the discontinuation reasons.  
2) The variable [ADSL.DCSREASGP] that groups the discontinuation reasons needs to be derived manually and provided in the input *adsl* dataset.  
```{r eval=FALSE}
run(dst01,adam_db=syn_data,detail_vars = list(Discontinued = c("DCSREASGP", "DCSREAS")),lbl_overall=NULL)
```
```{r echo=FALSE}
run(dst01,adam_db=syn_data,detail_vars = list(Discontinued = c("DCSREASGP", "DCSREAS")),lbl_overall=NULL)
```

#### **3. Patient Disposition (adding end of treatment status)**
The syntax below adds the end of treatment status to the standard patient disposition summary by providing the end of treatment status variable to the parameter *trt_status_var*.  
```{r eval=FALSE}
run(dst01,adam_db=syn_data,trt_status_var="EOTSTT",lbl_overall=NULL)
```
```{r echo=FALSE}
run(dst01,adam_db=syn_data,trt_status_var="EOTSTT",lbl_overall=NULL)
```

#### **4. Patient Disposition (adding details of study ongoing status)**
The syntax adds the details of study ongoing/alive status to the standard patient disposition summary by modifying the parameter *detail_vars*.
```{r eval=FALSE}
syn_data$adsl <- syn_data$adsl %>%
  mutate(STDONS = factor(case_when(EOTSTT == "ONGOING" & EOSSTT == "ONGOING" ~ "Alive: Ongoing",
                                   EOTSTT != "ONGOING" & EOSSTT == "ONGOING" ~ "Alive: In Follow-up",
                                  TRUE ~ NA_character_
                                  ),
                         levels = c("Alive: Ongoing", "Alive: In Follow-up")))
run(dst01, syn_data, detail_vars = list(Discontinued = "DCSREAS", Ongoing = "STDONS"))
```
```{r echo=FALSE}
syn_data$adsl <- syn_data$adsl %>%
  mutate(STDONS = factor(case_when(EOTSTT ==  "Ongoing Treatment" & EOSSTT == "Ongoing" ~ "Alive: Ongoing",
                                   EOTSTT !=  "Ongoing Treatment" & EOSSTT == "Ongoing" ~ "Alive: In Follow-up",
                                  TRUE ~ NA_character_
                                  ),
                         levels = c("Alive: Ongoing", "Alive: In Follow-up")))
run(dst01, syn_data, detail_vars = list(Discontinued = "DCSREAS", Ongoing = "STDONS"))
```

### **Deaths (DTHT01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_dtht01.html))**

#### **1. Deaths**
The **dtht01** template produces the standard deaths output.
```{r eval=FALSE}
run(dst01,adam_db=syn_data)
```
```{r echo=FALSE}
run(dst01,adam_db=syn_data)
```

#### **2. Deaths (adding "Primary Cause of Death" details for 'Other' category)**
```{r eval=FALSE}
run(dtht01,adam_db=syn_data,other_category = TRUE)
```
```{r echo=FALSE}
run(dtht01,adam_db=syn_data,other_category = TRUE)
```
NOTE: In order to avoid the warning above and display 'Other' as the last category under "Primary Cause of Death" right above the detailed reasons for "Other", the user is expected to manually provide levels to ADSL.DTHCAT based on categories available in the dataset.

#### **3. Deaths (adding summary by days from last study drug administration)**
Setting *time_since_last_dose* to *TRUE*, the syntax produces the count of deaths by days from last study drug administration as well as the count of deaths by primary cause and days from last study drug administration.
```{r eval=FALSE}
run(dtht01,adam_db=syn_data,time_since_last_dose=TRUE)
```
```{r echo=FALSE}
run(dtht01,adam_db=syn_data,time_since_last_dose=TRUE)
```

### **Study Drug Exposure (EXT01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_ext01.html))**

#### **1. Study Drug Exposure**
1) The **ext01** template displays total number of doses administered and total dose administered by default
2) The template does not include the column of total by default
```{r eval=FALSE}
run(ext01,adam_db=syn_data)
```
```{r echo=FALSE}
run(ext01,adam_db=syn_data)
```

### **Concomitnant Medications by Medication Class and Preferred Name (CMT01A) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_cmt01.html))**

#### **1. Concomitant Medications by Medication Class and Preferred Name**
1) The **cmt01a** template displays concomitant medications by ATC Level 2 and Preferred Name by default.  
2) The template does not include the column of total by default.  
3) The template sort medication class and preferred name by alphabetical order by default.  
```{r eval=FALSE}
run(cmt01a,adam_db=syn_data)
```
```{r echo=FALSE}
run(cmt01a,adam_db=syn_data)
```

#### **2. Concomitant Medications by Medication Class and Preferred Name (changing ATC class level)**
```{r eval=FALSE}
run(cmt01a,adam_db=syn_data,row_split_var = "ATC1")
```
```{r echo=FALSE}
run(cmt01a,adam_db=syn_data,row_split_var = "ATC1")
```

#### **3. Concomitant Medications by Medication Class and Preferred Name (classes sorted by frequency)**
The option **sort_by_freq* = TRUE sort medication class by frequency.
```{r eval=FALSE}
run(cmt01a,adam_db=syn_data,sort_by_freq = TRUE)
```
```{r echo=FALSE}
run(cmt01a,adam_db=syn_data,sort_by_freq = TRUE)
```

#### **4. Concomitant Medications by Medication Class and Preferred Name (total number of treatments per medication class suppressed)**
The **cmt01a** template includes the analysis of 'total number of treatments' by default, use *incl_n_treatment* = FALSE to remove it.
```{r eval=FALSE}
run(cmt01a,adam_db=syn_data,incl_n_treatment = FALSE)
```
```{r echo=FALSE}
run(cmt01a,adam_db=syn_data,incl_n_treatment = FALSE)
```

### **Concomitnant Medications by Preferred Name (CMT02_PT) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_cmt02_pt.html))**

#### **1. Concomitant Medications by Preferred Name**
1) The **cmt01_pt** template displays concomitant medications by Preferred Name by default.  
2) The template does not include the column of total by default.  
3) The template sorts preferred name by alphabetical order by default. Set the option **sort_by_freq* = TRUE  to sort preferred names by frequency.  
```{r eval=FALSE}
run(cmt02_pt,adam_db=syn_data)
```
```{r echo=FALSE}
run(cmt02_pt,adam_db=syn_data)
```

### **Medical History (MHT01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_mht01.html))**

#### **1. Medical History**
1) The **mht01** template displays medical conditions by MedDRA system organ class and Preferred Name by default.    
2) The default treatment variable is *ADSL.ARM*.   
3) The user is expected to use filter to subset medical conditions prior to or on entering study.  
4) By default, the template produces the overall 'total number of conditions' as well as the 'total number of conditions' per body system after the summary of patients  
5）This template currently does not support sorting MedDRA system organ class and preferred names by order of frequency.
```{r eval=FALSE}
run(mht01,adam_db=syn_data)
```
```{r echo=FALSE}
run(mht01,adam_db=syn_data)
```

#### **2. Medical History showing additional column 'All Patients'**
```{r eval=FALSE}
run(mht01,adam_db=syn_data,lbl_overall= "All Patients")
```
```{r echo=FALSE}
run(mht01,adam_db=syn_data,lbl_overall= "All Patients")
```

### **Vital Signs (VST01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_mht01.html))**

#### **1. Vital Sign Results and Change from Baseline by Visit**
```{r eval=FALSE}
run(vst01,adam_db=syn_data)
```
```{r echo=FALSE}
run(vst01,adam_db=syn_data)
```

### **Vital Signs Abnormalities (Regardless of Abnormality at Baseline) (VST02_1) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_vst02_1.html))**

#### **1. Vital Sign Abnormalities (Regardless of Abnormality at Baseline)**
```{r eval=FALSE}
run(vst02_1,adam_db=syn_data)
```
```{r echo=FALSE}
run(vst02_1,adam_db=syn_data)
```

### **Vital Signs Abnormalities (Among Subject Without Abnormality at Baseline) (VST02_2) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_vst02_2.html))**

#### **1. Vital Sign Abnormalities (Among Subject Without Abnormality at Baseline)**
```{r eval=FALSE}
run(vst02_2,adam_db=syn_data)
```
```{r echo=FALSE}
run(vst02_2,adam_db=syn_data)
```

### **Safety Summary (AET01) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet01.html))**

#### **1. Safety Summary**
The **aet01** template produces the standard safety summary.
```{r eval=FALSE}
run(aet01,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet01,adam_db=syn_data)
```

#### **2. Safety Summary with Modified Rows**
Analyses under "Total number of patients with at least one" can be removed, added, or modified by editing the parameter *anl_vars*. The defined analyses currently include "FATAL", "SER", "SERWD", "SERDSM", "RELSER", "WD", "DSM", "REL", "RELWD", "RELDSM", "SEV". When modification is made, analyses must be all listed in the parameter *anl_vars*. 
```{r eval=FALSE}
syn_data$adae <- syn_data$adae %>%
  mutate(RELCTC35 = with_label(.data$ATOXGR %in% c("3","4","5") & .data$AEREL == "Y","Related Grade 3-5"))
run(aet01,adam_db=syn_data,anl_vars = list(safety_var = c("FATAL","SER", "RELSER","RELCTC35")))
```
```{r echo=FALSE}
syn_data$adae <- syn_data$adae %>%
  mutate(RELCTC35 = with_label(.data$ATOXGR %in% c("3","4","5") & .data$AEREL == "Y","Related Grade 3-5"))
run(aet01,adam_db=syn_data,anl_vars = list(safety_var = c("FATAL","SER", "RELSER","RELCTC35")))
```

### **Safety Summary (Adverse Events of Special Interest) (AET01_AESI) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet01_aesi.html))**

#### **1. Safety Summary (Adverse Events of Special Interest)**
The **aet01_aesi** template produces the standard safety summary for adverse events of special interest.
```{r eval=FALSE}
run(aet01_aesi,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet01_aesi,adam_db=syn_data)
```

#### **2. Safety Summary (Adverse Events of Special Interest) (optional lines)**
Additional analyses can be added with the parameter *aesi_vars*, please type "?aet01_aesi" in the console to find out the list of all pre-defined optional analyses in the help.
```{r eval=FALSE}
run(aet01_aesi,adam_db=syn_data,aesi_vars = c("RESLWD","RELSER"))
```
```{r echo=FALSE}
run(aet01_aesi,adam_db=syn_data,aesi_vars = c("RESLWD","RELSER"))
```

#### **3. Safety Summary (Adverse Events of Special Interest) (for studies with multiple drugs)**
For studies with more than one study drug, user needs to define the analyses variable in *adae* and add to the parameter *aesi_vars* following the example above. No pre-defined analyses is available at this moment. 

### **Adverse Events (AET02) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet02.html))**

#### **1. Adverse Events**
1) The template *aet02* produces the standard adverse event summary by MedDRA system organ class and preferred term.
2) The template does not include the column of total as default. The 'All Patients' column can be added by *lbl_overall = "All Patients"*.
3) Missing values in AEBODSYS, and AEDECOD are labeled by *⁠No Coding availabl.*
```{r eval=FALSE}
run(aet02,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet02,adam_db=syn_data)
```

#### **2. Adverse Events (with High-level Term)**
The syntax below displays adverse events by MedDRA system organ class, high-level term and preferred term.
```{r eval=FALSE}
run(aet02,adam_db=syn_data,row_split_var =c("AEBODSYS","AEHLT"))
```
```{r echo=FALSE}
run(aet02,adam_db=syn_data,row_split_var =c("AEBODSYS","AEHLT"))
```

#### **3. Adverse Events (Preferred Terms only)**
The syntax below displays adverse events by preferred term only.
```{r eval=FALSE}
run(aet02,adam_db=syn_data,row_split_var =NULL)
```
```{r echo=FALSE}
run(aet02,adam_db=syn_data,row_split_var =NULL)
```

### **Adverse Events by Greatest Intensity(AET03) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet03.html))**

#### **1. Adverse Events by Greatest Intensity**
This **aet03** template  produces the standard adverse event by greatest intensity summary
```{r eval=FALSE}
run(aet03,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet03,adam_db=syn_data)
```

### **Adverse Events by Highest NCI CTCAE Grade (AET04) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet04.html))**

#### **1. Adverse Events by Highest NCI CTCAE Grade**
1) The **aet04** template produces the standard adverse event by highest NCI CTCAE grade summary.  
2) By default, this template includes the grouped grades of 'Grade 1-2' and 'Grade 3-4'.   
3) By default this template removes the rows with 0 count.   
4) If a treatment group does not have any AE, the treatment group is automatically displayed providing that it is defined in ADSL.  
```{r eval=FALSE}
run(aet04,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet04,adam_db=syn_data)
```

#### **2. Adverse Events by Highest NCI CTCAE Grade (Fill in of Grades)**
If for some preferred terms not all grades occur but all grades should be displayed, this can be achieved by specifying *prune_0=FALSE*.
```{r eval=FALSE}
run(aet04,adam_db=syn_data,prune_0=FALSE)
```
```{r echo=FALSE}
run(aet04,adam_db=syn_data,prune_0=FALSE)
```

#### **3. Adverse Events by Highest NCI CTCAE Grade with modified grouping of grade**
To collapse grade 3-4 with grade 5, this can be achieved by modifying the definition of grade groups in *grade_groups*.
```{r eval=FALSE}
grade_groups <- list(
  "Grade 1-2" = c("1", "2"),
  "Grade 3-5" = c("3", "4", "5")
)
run(aet04, syn_data, grade_groups = grade_groups,prune_0=FALSE)
```
```{r echo=FALSE}
grade_groups <- list(
  "Grade 1-2" = c("1", "2"),
  "Grade 3-5" = c("3", "4", "5")
)
run(aet04, syn_data, grade_groups = grade_groups,prune_0=FALSE)
```

### **Most Common (>=5%) Adverse Events (AET05) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_aet10.html))**
#### **1. Most Common (>=5%) Adverse Events**
1) The *aet10* template produces the standard most common adverse events occurring with relative frequency >=5% output.
```{r eval=FALSE}
run(aet10,adam_db=syn_data)
```
```{r echo=FALSE}
run(aet10,adam_db=syn_data)
```

#### **2. Most Common (>=8%) Adverse Events (setting threshold)**
To modify the threshold for displaying preferred terms, this can be achieved by providing the threshold to the *atleast* parameter.  
```{r eval=FALSE}
run(aet10,adam_db=syn_data, atleast=0.08)
```
```{r echo=FALSE}
run(aet10,adam_db=syn_data,atleast=0.08)
```


## **LISTINGS**

### **Glossary of Adverse Event Preferred Terms and Investigator-Specified Terms (AEL01_NOLLT) ([STREAM v2.12 Link](https://pages.github.roche.com/MDIS/stream_doc/2_12/um/report_outputs_ael01_nollt.html))**
#### **1. Glossary of Adverse Event Preferred Terms and Investigator-Specified Terms**
The **ael01_nollt** template produces the standard glossary of adverse event preferred terms and investigator-specified terms.
```{r eval=FALSE}
l_ae_nollt<-run(ael01_nollt,adam_db=syn_data)
head(l_ae_nollt,10)
```
```{r echo=FALSE}
l_ae_nollt<-run(ael01_nollt,adam_db=syn_data)
head(l_ae_nollt,10)
```
